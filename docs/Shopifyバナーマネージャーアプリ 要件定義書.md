## 1. アプリケーション概要

| 項目        | 内容                                                          |
| --------- | ----------------------------------------------------------- |
| アプリケーション名 | Shopifyインフォメーションバナーマネージャー                                   |
| 目的        | Shopifyストアのページ最上部に、期間や表示回数を細かく設定可能なインフォメーションバナーを容易に表示・管理する。 |
| ターゲットユーザー | Shopifyを利用するマーチャント（ストア管理者）                                  |
| 技術スタック    | React (Polaris), Cloudflare Workers, Cloudflare D1          |

## 2. 機能要件 (Functional Requirements: FR)

### 2.1. バナー設定・管理機能 (CRUD)

|ID|機能|概要|
|---|---|---|
|FR-101|バナーの追加/編集/削除|バナーの内容、デザイン、表示条件を設定し、保存・更新・削除できる。|
|FR-102|バナー内容設定|文言（複数言語対応は検討外）、リンクURL、バナー名を設定できる。|
|FR-103|バナーデザイン設定|背景色、文字色、フォントサイズなどを設定できる。|
|FR-104|自動表示設定（期間）|表示開始日時と終了日時を設定し、期間外は自動的に非表示にする。|
|FR-105|バナーの有効/無効切り替え|ワンクリックでバナーの表示/非表示を即座に切り替えられる。|
|**FR-106**|**表示対象ページ選択 (新規)**|**バナーを表示するShopifyストア内のページURL（パス）を設定できる。** - 設定オプション: 1. 全てのページ、2. 特定のパスを含むページ、3. 特定のパスを除外するページ。|

### 2.2. 表示制御機能

|ID|機能|概要|
|---|---|---|
|FR-201|表示パターン設定|ユーザーごとに以下の表示頻度を設定できる。 - 常に表示 / 一回のみ表示 / 一日一度のみ表示|
|FR-202|複数パターン表示設定|複数の有効なバナーがある場合、表示順序を以下から選択できる。 - 優先度順（固定） / 順番にローテーション / ランダム表示|
|FR-203|カウントダウンバナー|終了日時を設定することで、残り時間を表示するバナーを設定できる。|

### 2.3. 課金・プラン管理機能 (Billing)

| ID     | 機能             | 概要                                                                                     |
| ------ | -------------- | -------------------------------------------------------------------------------------- |
| FR-301 | プラン管理機能        | 複数の定額プランから選択し、プランの変更・アップグレード・ダウングレードが可能。                                           |
| FR-302 | 定額課金対応         | ShopifyのRecurring Application Charge APIを利用し、月額定額課金を行う。                                           |
| FR-303 | プラン構造          | 以下のプラン構造を提供する。 - フリープラン: 月間 1,000回まで無料 - ベーシックプラン: 月間 10,000回まで $9.99/月 - プロプラン: 月間 50,000回まで $29.99/月 - エンタープライズプラン: 無制限 $99.99/月 |
| FR-304 | **プラン制限の制御**    | **プラン制限を超過した場合、ストアフロントでのバナー表示を停止する。**                                               |
| FR-305 | **制限超過時の管理画面通知** | **プラン制限超過時、管理画面にエラーメッセージを表示し、プランアップグレードを促す。**                                            |
| FR-306 | **プラン変更機能**      | **管理画面からプランの変更（アップグレード・ダウングレード）が可能。**                                                |
| FR-307 | **利用状況表示**       | **現在のプラン、利用状況、制限までの残り回数を管理画面に表示。**                                                    |

## 3. 非機能要件

|項目|内容|
|---|---|
|パフォーマンス|ストアフロントへの影響を最小限にするため、バナー表示スクリプトは軽量かつ高速であること。|
|スケーラビリティ|Cloudflare WorkersとD1により、大規模ストアのトラフィックにも耐えられること。|
|可用性|99.9%以上の稼働率を目指す。|
|セキュリティ|Shopifyの認証およびデータ保護要件を遵守する。|
